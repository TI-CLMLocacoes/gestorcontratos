<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Contratos de TI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Fundo cinza claro */
        }
        .sidebar {
            transition: transform 0.3s ease-in-out;
        }
        .main-content {
            transition: margin-left 0.3s ease-in-out;
        }
        .modal-backdrop {
            background-color: rgba(0,0,0,0.5);
            transition: opacity 0.3s ease-in-out;
        }
        .modal-content {
            transition: transform 0.3s ease-in-out;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .table-auto th, .table-auto td {
            padding: 12px 15px;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside id="sidebar" class="bg-gray-800 text-white w-64 space-y-6 py-7 px-2 absolute inset-y-0 left-0 transform -translate-x-full md:relative md:translate-x-0 sidebar">
            <a href="#" class="text-white flex items-center space-x-2 px-4">
                <i class="fas fa-tasks text-2xl"></i>
                <span class="text-2xl font-extrabold">Gestor TI</span>
            </a>

            <nav>
                <a href="#" onclick="showView('dashboard')" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 bg-gray-700">
                    <i class="fas fa-chart-line mr-2"></i>Dashboard
                </a>
                <a href="#" onclick="showView('atividades')" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700">
                    <i class="fas fa-stopwatch mr-2"></i>Atividades
                </a>
                 <a href="#" onclick="showView('projetos')" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700">
                    <i class="fas fa-project-diagram mr-2"></i>Projetos
                </a>
                <a href="#" onclick="showView('contratos')" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700">
                    <i class="fas fa-file-signature mr-2"></i>Contratos
                </a>
                <a href="#" onclick="showView('fornecedores')" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700">
                    <i class="fas fa-building mr-2"></i>Fornecedores
                </a>
                <a href="#" onclick="showView('analistas')" class="nav-link block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700">
                    <i class="fas fa-users-cog mr-2"></i>Analistas
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div id="main-content" class="flex-1 flex flex-col overflow-hidden main-content">
            <header class="flex justify-between md:justify-end items-center p-4 bg-white border-b-2">
                 <button id="menu-button" class="text-gray-500 focus:outline-none md:hidden">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
                <div class="text-gray-600">Visão Geral</div>
            </header>
            
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6">
                <!-- VIEW: Dashboard -->
                <div id="view-dashboard" class="view">
                    <h2 class="text-3xl font-bold mb-6 text-gray-800">Dashboard</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <!-- Stat Cards -->
                        <div class="bg-white p-6 rounded-lg shadow-md stat-card transition-transform duration-300">
                            <div class="flex items-center">
                                <div class="bg-blue-500 text-white rounded-full p-3 mr-4">
                                    <i class="fas fa-dollar-sign fa-2x"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500">Custo Total (Mês)</p>
                                    <p id="stat-custo-total" class="text-2xl font-bold text-gray-800">R$ 0,00</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md stat-card transition-transform duration-300">
                            <div class="flex items-center">
                                <div class="bg-green-500 text-white rounded-full p-3 mr-4">
                                    <i class="fas fa-clock fa-2x"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500">Horas Totais (Mês)</p>
                                    <p id="stat-horas-totais" class="text-2xl font-bold text-gray-800">0.00h</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md stat-card transition-transform duration-300">
                             <div class="flex items-center">
                                <div class="bg-yellow-500 text-white rounded-full p-3 mr-4">
                                    <i class="fas fa-project-diagram fa-2x"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500">Projetos Ativos</p>
                                    <p id="stat-projetos-ativos" class="text-2xl font-bold text-gray-800">0</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md stat-card transition-transform duration-300">
                             <div class="flex items-center">
                                <div class="bg-red-500 text-white rounded-full p-3 mr-4">
                                    <i class="fas fa-file-signature fa-2x"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-500">Contratos Vencendo</p>
                                    <p id="stat-contratos-vencendo" class="text-2xl font-bold text-gray-800">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="font-bold text-gray-700 mb-4">Custo por Projeto (Mês)</h3>
                            <div id="chart-custo-projeto" class="space-y-3">
                                <!-- Chart content generated by JS -->
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="font-bold text-gray-700 mb-4">Atividades Recentes</h3>
                            <ul id="lista-atividades-recentes" class="space-y-4">
                                <!-- List content generated by JS -->
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- VIEWS para cada entidade -->
                <div id="view-fornecedores" class="view hidden"></div>
                <div id="view-contratos" class="view hidden"></div>
                <div id="view-projetos" class="view hidden"></div>
                <div id="view-analistas" class="view hidden"></div>
                <div id="view-atividades" class="view hidden"></div>
            </main>
        </div>
    </div>

    <!-- MODAL Genérico -->
    <div id="modal" class="fixed inset-0 z-50 items-center justify-center hidden modal-backdrop">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg p-6 modal-content transform scale-95">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modal-title" class="text-2xl font-bold text-gray-800"></h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-800">&times;</button>
            </div>
            <div id="modal-body">
                <!-- Conteúdo do formulário injetado via JS -->
            </div>
        </div>
    </div>

<script>
// ---------- CONFIGURAÇÃO INICIAL E ESTADO DA APLICAÇÃO ----------
const state = {
    fornecedores: [],
    contratos: [],
    projetos: [],
    analistas: [],
    atividades: []
};

document.addEventListener('DOMContentLoaded', () => {
    loadState();
    setupEventListeners();
    showView('dashboard');
});

function setupEventListeners() {
    document.getElementById('menu-button').addEventListener('click', () => {
        const sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('-translate-x-full');
    });

    document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', (e) => {
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('bg-gray-700'));
            e.currentTarget.classList.add('bg-gray-700');
            const sidebar = document.getElementById('sidebar');
            if (!sidebar.classList.contains('md:relative')) {
                 sidebar.classList.add('-translate-x-full');
            }
        });
    });
}

// ---------- GESTÃO DE ESTADO (LOCALSTORAGE) ----------
function saveState() {
    localStorage.setItem('gestorTiState', JSON.stringify(state));
}

function loadState() {
    const savedState = localStorage.getItem('gestorTiState');
    if (savedState) {
        Object.assign(state, JSON.parse(savedState));
    }
}

function generateId() {
    return Date.now().toString(36) + Math.random().toString(36).substr(2);
}

// ---------- GESTÃO DE VIEWS E MODAIS ----------
function showView(viewName) {
    document.querySelectorAll('.view').forEach(view => view.classList.add('hidden'));
    const activeView = document.getElementById(`view-${viewName}`);
    activeView.classList.remove('hidden');
    
    // O dashboard tem uma estrutura estática, apenas os dados são atualizados.
    // As outras views têm seu conteúdo gerado dinamicamente.
    if (viewName !== 'dashboard') {
        activeView.innerHTML = ''; // Limpa a view para renderizar novamente
    }

    switch(viewName) {
        case 'dashboard': renderDashboard(); break;
        case 'fornecedores': renderEntityListView('fornecedores'); break;
        case 'contratos': renderEntityListView('contratos'); break;
        case 'projetos': renderEntityListView('projetos'); break;
        case 'analistas': renderEntityListView('analistas'); break;
        case 'atividades': renderEntityListView('atividades'); break;
    }
}

function openModal(title, formHtml) {
    document.getElementById('modal-title').innerText = title;
    document.getElementById('modal-body').innerHTML = formHtml;
    document.getElementById('modal').classList.remove('hidden');
    document.getElementById('modal').classList.add('flex');
    setTimeout(() => {
        document.querySelector('.modal-backdrop').classList.add('opacity-100');
        document.querySelector('.modal-content').classList.remove('scale-95');
    }, 10);
}

function closeModal() {
    const modal = document.getElementById('modal');
    document.querySelector('.modal-backdrop').classList.remove('opacity-100');
    document.querySelector('.modal-content').classList.add('scale-95');
    setTimeout(() => {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
    }, 300);
}

// ---------- RENDERIZAÇÃO DAS ENTIDADES (VIEWS DE LISTA) ----------
const entityConfig = {
    fornecedores: {
        title: "Fornecedores",
        fields: { nome: "Nome", cnpj: "CNPJ", contato: "Contato", valorHoraPadrao: "Valor Hora Padrão (R$)" },
        columns: item => `<td>${item.nome}</td><td>${item.cnpj}</td><td>${item.contato}</td><td>${formatCurrency(item.valorHoraPadrao)}</td>`
    },
    contratos: {
        title: "Contratos",
        fields: { idContrato: "ID Contrato", fornecedorId: "Fornecedor", dataContratacao: "Data Contratação", periodo: "Período (meses)", valorMensal: "Valor Mensal (R$)" },
        columns: item => `<td>${item.idContrato}</td><td>${getFornecedorName(item.fornecedorId)}</td><td>${formatDate(item.dataContratacao)}</td><td>${item.periodo}</td><td>${formatCurrency(item.valorMensal)}</td><td>${formatDate(DATE_ADD(item.dataContratacao, item.periodo))}</td>`,
        extraHeaders: '<th>Data Vencimento</th>'
    },
    projetos: {
        title: "Projetos",
        fields: { nome: "Nome", contratoId: "Contrato", status: "Status" },
        columns: item => `<td>${item.nome}</td><td>${getContratoName(item.contratoId)}</td><td>${item.status}</td>`
    },
    analistas: {
        title: "Analistas",
        fields: { nome: "Nome", fornecedorId: "Fornecedor", valorHoraEspecifico: "Valor Hora Específico (R$)" },
        columns: item => `<td>${item.nome}</td><td>${getFornecedorName(item.fornecedorId)}</td><td>${item.valorHoraEspecifico ? formatCurrency(item.valorHoraEspecifico) : 'Padrão'}</td>`
    },
    atividades: {
        title: "Atividades",
        fields: { projetoId: "Projeto", analistaId: "Analista", descricao: "Descrição", data: "Data", horaInicio: "Hora Início", horaTermino: "Hora Término" },
        columns: item => `<td>${getProjetoName(item.projetoId)}</td><td>${getAnalistaName(item.analistaId)}</td><td>${item.descricao}</td><td>${formatDate(item.data)}</td><td>${item.duracao.toFixed(2)}h</td><td>${formatCurrency(item.custo)}</td>`,
        extraHeaders: '<th>Duração</th><th>Custo</th>'
    }
};

function renderEntityListView(entityName) {
    const config = entityConfig[entityName];
    const view = document.getElementById(`view-${entityName}`);
    
    let tableHeaders = Object.values(config.fields).map(h => `<th>${h}</th>`).join('');
    if (config.extraHeaders) tableHeaders += config.extraHeaders;

    view.innerHTML = `
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-3xl font-bold text-gray-800">${config.title}</h2>
            <button onclick="showForm('${entityName}')" class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition duration-300">
                <i class="fas fa-plus mr-2"></i> Adicionar
            </button>
        </div>
        <div class="bg-white rounded-lg shadow overflow-x-auto">
            <table class="w-full table-auto">
                <thead class="bg-gray-50 border-b-2 border-gray-200">
                    <tr>${tableHeaders}<th>Ações</th></tr>
                </thead>
                <tbody id="${entityName}-table-body">
                    <!-- Dados inseridos via JS -->
                </tbody>
            </table>
        </div>
    `;

    const tableBody = document.getElementById(`${entityName}-table-body`);
    tableBody.innerHTML = '';
    state[entityName].forEach(item => {
        const row = document.createElement('tr');
        row.className = 'border-b hover:bg-gray-50';
        row.innerHTML = `
            ${config.columns(item)}
            <td class="text-center">
                <button onclick="showForm('${entityName}', '${item.id}')" class="text-blue-500 hover:text-blue-700 p-2"><i class="fas fa-edit"></i></button>
                <button onclick="deleteItem('${entityName}', '${item.id}')" class="text-red-500 hover:text-red-700 p-2"><i class="fas fa-trash"></i></button>
            </td>
        `;
        tableBody.appendChild(row);
    });
}


// ---------- GESTÃO DE FORMULÁRIOS E DADOS (CRUD) ----------

function showForm(entityName, id = null) {
    const isEditing = id !== null;
    const item = isEditing ? state[entityName].find(i => i.id === id) : {};
    const config = entityConfig[entityName];
    
    let formFieldsHtml = '';
    for (const [key, label] of Object.entries(config.fields)) {
        const value = item[key] || '';
        if (key.includes('Id')) { // Campos de relacionamento (select)
            formFieldsHtml += createSelectField(key, label, value);
        } else if (key.includes('data')) {
            formFieldsHtml += createInputField('date', key, label, value);
        } else if (key.includes('hora')) {
            formFieldsHtml += createInputField('time', key, label, value);
        } else if (label.includes('R$')) {
            formFieldsHtml += createInputField('number', key, label, value);
        } else if (key === 'status' && entityName === 'projetos') {
            formFieldsHtml += createSelectField('status', 'Status', value, [{id: 'Ativo', nome: 'Ativo'}, {id: 'Pausado', nome: 'Pausado'}, {id: 'Concluído', nome: 'Concluído'}]);
        } else {
            formFieldsHtml += createInputField('text', key, label, value);
        }
    }

    const formHtml = `
        <form onsubmit="handleSubmit(event, '${entityName}', ${isEditing ? `'${id}'` : null})">
            <div class="space-y-4">${formFieldsHtml}</div>
            <div class="mt-6 flex justify-end">
                <button type="button" onclick="closeModal()" class="mr-3 bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300">Cancelar</button>
                <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">${isEditing ? 'Salvar Alterações' : 'Criar'}</button>
            </div>
        </form>
    `;
    
    openModal(`${isEditing ? 'Editar' : 'Adicionar'} ${config.title}`, formHtml);
}

function createInputField(type, id, label, value) {
    const step = type === 'number' ? 'step="0.01"' : '';
    const placeholder = label.includes('R$') ? 'Ex: 150.50' : '';
    return `
        <div>
            <label for="${id}" class="block text-sm font-medium text-gray-700">${label}</label>
            <input type="${type}" id="${id}" name="${id}" value="${value}" ${step} placeholder="${placeholder}" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
        </div>
    `;
}

function createSelectField(key, label, value, customOptions = null) {
    let options = [];
    if (customOptions) {
        options = customOptions;
    } else if (key === 'fornecedorId') {
        options = state.fornecedores.map(f => ({ id: f.id, nome: f.nome }));
    } else if (key === 'contratoId') {
        options = state.contratos.map(c => ({ id: c.id, nome: c.idContrato }));
    } else if (key === 'projetoId') {
        options = state.projetos.map(p => ({ id: p.id, nome: p.nome }));
    } else if (key === 'analistaId') {
        options = state.analistas.map(a => ({ id: a.id, nome: a.nome }));
    }

    const optionsHtml = options.map(o => `<option value="${o.id}" ${o.id === value ? 'selected' : ''}>${o.nome}</option>`).join('');
    
    return `
        <div>
            <label for="${key}" class="block text-sm font-medium text-gray-700">${label}</label>
            <select id="${key}" name="${key}" required class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                <option value="">Selecione...</option>
                ${optionsHtml}
            </select>
        </div>
    `;
}


function handleSubmit(event, entityName, id) {
    event.preventDefault();
    const formData = new FormData(event.target);
    const newItem = id ? state[entityName].find(i => i.id === id) : { id: generateId() };

    for (const [key, value] of formData.entries()) {
        newItem[key] = value;
    }

    if (entityName === 'atividades') {
        calculateActivityCost(newItem);
    }
    
    if (id) {
        // Update
        const index = state[entityName].findIndex(i => i.id === id);
        state[entityName][index] = newItem;
    } else {
        // Create
        state[entityName].push(newItem);
    }

    saveState();
    showView(entityName);
    closeModal();
}

function deleteItem(entityName, id) {
    if (confirm(`Tem certeza que deseja excluir este item?`)) {
        state[entityName] = state[entityName].filter(item => item.id !== id);
        saveState();
        showView(entityName);
    }
}

// ---------- CÁLCULOS E LÓGICA DE NEGÓCIO ----------

function calculateActivityCost(activity) {
    const startTime = new Date(`1970-01-01T${activity.horaInicio}`);
    const endTime = new Date(`1970-01-01T${activity.horaTermino}`);
    const durationMinutes = (endTime - startTime) / (1000 * 60);
    activity.duracao = durationMinutes / 60; // Duração em horas

    const analista = state.analistas.find(a => a.id === activity.analistaId);
    let hourlyRate = 0;
    if (analista.valorHoraEspecifico && parseFloat(analista.valorHoraEspecifico) > 0) {
        hourlyRate = parseFloat(analista.valorHoraEspecifico);
    } else {
        const fornecedor = state.fornecedores.find(f => f.id === analista.fornecedorId);
        hourlyRate = parseFloat(fornecedor.valorHoraPadrao);
    }
    activity.custo = activity.duracao * hourlyRate;
}

function DATE_ADD(dateStr, months) {
    const date = new Date(dateStr);
    date.setMonth(date.getMonth() + parseInt(months));
    return date;
}

// ---------- FUNÇÕES AUXILIARES (GETTERS E FORMATTERS) ----------
function getFornecedorName(id) { return state.fornecedores.find(f => f.id === id)?.nome || 'N/A'; }
function getContratoName(id) { return state.contratos.find(c => c.id === id)?.idContrato || 'N/A'; }
function getProjetoName(id) { return state.projetos.find(p => p.id === id)?.nome || 'N/A'; }
function getAnalistaName(id) { return state.analistas.find(a => a.id === id)?.nome || 'N/A'; }

function formatCurrency(value) {
    return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value || 0);
}

function formatDate(dateString) {
    if (!dateString) return 'N/A';
    const date = new Date(dateString);
    // Adiciona 1 dia para corrigir problema de fuso horário na exibição
    const adjustedDate = new Date(date.getTime() + Math.abs(date.getTimezoneOffset()*60000));
    return adjustedDate.toLocaleDateString('pt-BR');
}

// ---------- RENDERIZAÇÃO DO DASHBOARD ----------
function renderDashboard() {
    // Filtrar atividades do mês corrente
    const today = new Date();
    const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
    const lastDayOfMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0);

    const atividadesMes = state.atividades.filter(a => {
        const activityDate = new Date(a.data);
        return activityDate >= firstDayOfMonth && activityDate <= lastDayOfMonth;
    });

    // Cálculos
    const custoTotal = atividadesMes.reduce((sum, a) => sum + (a.custo || 0), 0);
    const horasTotais = atividadesMes.reduce((sum, a) => sum + (a.duracao || 0), 0);
    const projetosAtivos = state.projetos.filter(p => p.status === 'Ativo').length;
    
    const thirtyDaysFromNow = new Date();
    thirtyDaysFromNow.setDate(today.getDate() + 30);
    const contratosVencendo = state.contratos.filter(c => {
        const vencimento = DATE_ADD(c.dataContratacao, c.periodo);
        return vencimento <= thirtyDaysFromNow && vencimento >= today;
    }).length;

    // Atualiza stats
    document.getElementById('stat-custo-total').textContent = formatCurrency(custoTotal);
    document.getElementById('stat-horas-totais').textContent = `${horasTotais.toFixed(2)}h`;
    document.getElementById('stat-projetos-ativos').textContent = projetosAtivos;
    document.getElementById('stat-contratos-vencendo').textContent = contratosVencendo;

    // Gráfico de Custo por Projeto
    const custoPorProjeto = {};
    atividadesMes.forEach(a => {
        const nomeProjeto = getProjetoName(a.projetoId);
        if (!custoPorProjeto[nomeProjeto]) custoPorProjeto[nomeProjeto] = 0;
        custoPorProjeto[nomeProjeto] += a.custo;
    });

    const chartContainer = document.getElementById('chart-custo-projeto');
    chartContainer.innerHTML = '';
    const maxCost = Math.max(...Object.values(custoPorProjeto), 1);
    Object.entries(custoPorProjeto).sort(([,a],[,b]) => b-a).forEach(([nome, custo]) => {
        const percentage = (custo / maxCost) * 100;
        chartContainer.innerHTML += `
            <div>
                <div class="flex justify-between text-sm text-gray-600">
                    <span>${nome}</span>
                    <span>${formatCurrency(custo)}</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5 mt-1">
                    <div class="bg-blue-600 h-2.5 rounded-full" style="width: ${percentage}%"></div>
                </div>
            </div>
        `;
    });
     if (Object.keys(custoPorProjeto).length === 0) {
        chartContainer.innerHTML = '<p class="text-center text-gray-500">Nenhum custo registrado este mês.</p>';
    }

    // Lista de Atividades Recentes
    const listaRecentes = document.getElementById('lista-atividades-recentes');
    listaRecentes.innerHTML = '';
    state.atividades.sort((a, b) => new Date(b.data) - new Date(a.data)).slice(0, 5).forEach(a => {
        listaRecentes.innerHTML += `
            <li class="flex items-center justify-between p-2 rounded hover:bg-gray-50">
                <div>
                    <p class="font-medium text-gray-800">${a.descricao}</p>
                    <p class="text-sm text-gray-500">${getAnalistaName(a.analistaId)} em ${getProjetoName(a.projetoId)}</p>
                </div>
                <div class="text-right">
                    <p class="font-semibold text-gray-700">${formatCurrency(a.custo)}</p>
                    <p class="text-xs text-gray-400">${formatDate(a.data)}</p>
                </div>
            </li>
        `;
    });
    if (state.atividades.length === 0) {
        listaRecentes.innerHTML = '<p class="text-center text-gray-500">Nenhuma atividade registrada.</p>';
    }
}

</script>
</body>
</html>